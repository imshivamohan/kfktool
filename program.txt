from confluent_kafka import Producer

# Configure the Kafka producer
producer_config = {
    'bootstrap.servers': 'your_bootstrap_servers',
    'key.serializer': 'confluent_kafka.serializers.StringSerializer',
    'value.serializer': 'confluent_kafka.serializers.JsonSerializer'
}

# Create the Kafka producer
kafka_producer = Producer(producer_config)

# Define your JSON payload
json_payload = {
    'field1': 'value1',
    'field2': 'value2',
}

# Define the schema ID
schema_id = 123  # Replace with your actual schema ID

# Produce the message
try:
    kafka_producer.produce(
        topic='your_topic',
        value=json_payload,
        headers={'schema_id': str(schema_id)}
    )
except Exception as e:
    print(f"Message production failed: {e}")

# Flush the producer to ensure the message is sent
kafka_producer.flush()
