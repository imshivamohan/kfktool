import requests

def fetch_schema(schema_url, schema_api_key, schema_api_secret, topic):
    auth = (schema_api_key, schema_api_secret)
    url = f"{schema_url}/subjects/{topic}-value/versions/latest"
    headers = {
        "Content-Type": "application/vnd.schemaregistry.v1+json",
        "Accept": "application/vnd.schemaregistry.v1+json"
    }

    response = requests.get(url, headers=headers, auth=auth)
    response.raise_for_status()

    return response.json()




schema_url = "https://schema-registry.example.com"
schema_api_key = "your-schema-api-key"
schema_api_secret = "your-schema-api-secret"
topic = "your-topic-name"

schema = fetch_schema(schema_url, schema_api_key, schema_api_secret, topic)
print(schema)
